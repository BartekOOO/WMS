<!DOCTYPE html>
<html lang="pl"
      xmlns:th="http://www.thymeleaf.org">
<body>

<div th:fragment="fragment">

    <section class="card">

        <div class="alert-glass alert-glass--success" th:if="${success != null}">
            <div class="alert-glass__icon">✓</div>
            <div class="alert-glass__content">
                <div class="alert-glass__title">Sukces</div>
                <div class="alert-glass__msg" th:text="${success}">OK</div>
            </div>
        </div>

        <div class="alert-glass alert-glass--danger" th:if="${error != null}">
            <div class="alert-glass__icon">!</div>
            <div class="alert-glass__content">
                <div class="alert-glass__title">Błąd</div>
                <div class="alert-glass__msg" th:text="${error}">Coś nie tak</div>
            </div>
        </div>




        <header class="card-h">
            <div style="display:flex;flex-direction:column;gap:4px;min-width:0">
                <h2>Dodawanie adresu</h2>
                <div style="color:rgba(255,255,255,0.65);font-size:.92rem">
                    Adres zostanie przypisany do wybranego kontrahenta.
                </div>
            </div>

            <div class="card-actions">
                <a class="chip"
                   th:href="@{/Customers/GetCustomers}">
                    Wróć
                </a>
            </div>
        </header>

        <div class="card-b">

            <!-- komunikat błędu ogólnego -->
            <div class="alert alert-err" th:if="${error}">
                <div class="alert-title">Nie udało się wykonać operacji</div>
                <div class="alert-body" th:text="${error}">Błąd</div>
            </div>

            <!-- PODGLĄD KONTRAHENTA (tylko do odczytu) -->
            <div class="subcard" th:if="${customer != null}">
                <div class="subcard-title">Kontrahent</div>

                <div class="grid-2">
                    <div class="field">
                        <label>Nazwa</label>
                        <input class="input" type="text"
                               th:value="${customer.fullName}"
                               readonly />
                    </div>

                    <div class="field">
                        <label>NIP</label>
                        <input class="input mono" type="text"
                               th:value="${customer.nip}"
                               readonly />
                    </div>
                </div>


            </div>

            <form class="form"
                  th:action="@{/Addresses/RegisterAddress}"
                  th:object="${address}"
                  method="post">

                <!-- przeniesienie customerId w commandzie -->
                <input type="hidden" th:field="*{customerId}"/>

                <!-- Jeśli kiedyś dodasz magazyn w UI, zostawiam pole: -->
                <input type="hidden" th:field="*{warehouseId}"/>

                <div class="grid-2">
                    <div class="field">
                        <label for="street">Ulica</label>
                        <input id="street" class="input" type="text"
                               th:field="*{address.street}"
                               placeholder="np. Tulipanowa 20/3"
                               autocomplete="street-address"
                               required />
                        <div class="hint">Wpisz ulicę wraz z numerem.</div>
                        <div class="err" th:if="${#fields.hasErrors('address.street')}"
                             th:errors="*{address.street}">Błąd</div>
                    </div>

                    <div class="field">
                        <label for="city">Miasto</label>
                        <input id="city" class="input" type="text"
                               th:field="*{address.city}"
                               placeholder="np. Warszawa"
                               autocomplete="address-level2"
                               required />
                        <div class="err" th:if="${#fields.hasErrors('address.city')}"
                             th:errors="*{address.city}">Błąd</div>
                    </div>

                    <div class="field">
                        <label for="state">Województwo / Stan</label>
                        <input id="state" class="input" type="text"
                               th:field="*{address.state}"
                               placeholder="np. Mazowieckie"
                               autocomplete="address-level1" />
                        <div class="err" th:if="${#fields.hasErrors('address.state')}"
                             th:errors="*{address.state}">Błąd</div>
                    </div>

                    <div class="field">
                        <label for="zipCode">Kod pocztowy</label>
                        <input id="zipCode" class="input mono" type="text"
                               th:field="*{address.zipCode}"
                               placeholder="00-001"
                               autocomplete="postal-code" />
                        <div class="err" th:if="${#fields.hasErrors('address.zipCode')}"
                             th:errors="*{address.zipCode}">Błąd</div>
                    </div>

                    <div class="field">
                        <label for="country">Kraj</label>
                        <input id="country" class="input" type="text"
                               th:field="*{address.country}"
                               placeholder="PL / Polska"
                               autocomplete="country" />
                        <div class="err" th:if="${#fields.hasErrors('address.country')}"
                             th:errors="*{address.country}">Błąd</div>
                    </div>
                </div>

                <div class="form-actions">
                    <a class="btn ghost"
                       th:href="@{/Customers/EditForm(id=${customer != null ? customer.id : address.customerId})}">
                        Anuluj
                    </a>

                    <button class="btn primary" type="submit">
                        Zapisz adres
                    </button>
                </div>

            </form>

        </div>
    </section>

</div>
</body>
</html>
